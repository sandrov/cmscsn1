<!DOCTYPE html>
<head>
<meta http-equiv="expires" content="Sun, 01 Jan 2014 00:00:00 GMT"/>
<meta http-equiv="pragma" content="no-cache" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-teal.css">
<style>
html {
  font-family:Montserrat,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;
  line-height:1.5
}
.entrasel {  }
.fte{ display:none;}


</style>
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://webanalytics.web.cern.ch/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '639']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
<script>
var mfilt="";
var mfilts="";
	var myrates={BA: 4.05, BO: 3.8, CT: 4.05, FI: 3.8, GE: 3.7, LNF: 3.7, LNL: 3.8, MIB: 3.7, NA: 3.95, PD: 3.8, PV: 3.7, PG:3.95, PI: 3.8, 
			RM1: 3.7, TO: 3.7, TS: 3.95};
	var mylvlmon={L0: 4, L1: 3, L2: 1, L3: 0,nc: 0, 'L1.5': 0}
        
	function respcalc() {
                 var msez= document.getElementById('ricsez').value;
                 var mlvl= document.getElementById('rictag3').value;
                 var mykeur= myrates[msez]*mylvlmon[mlvl]+0.25;
                 var a = parseInt(mykeur);
                 if ((mykeur-a)<0.5) mykeur=a;
                 else mykeur=a+0.5;

		 document.getElementById('keur').value=mykeur;
		 if (mylvlmon[mlvl]>0) {
			document.getElementById('rich').value=mylvlmon[mlvl]+" mp*"+myrates[msez]+" KEuro/mp";}
		 else  document.getElementById('rich').value="";
		};

	function metalbl() {
			var msez= document.getElementById('ricsez').value;
			var mylbl= document.getElementById('rictag2').value;
			if (mylbl=="META" || mylbl=="ESP") {
					 document.getElementById('divlbl').style.display='inline';
				         document.getElementById('lblriclbl').innerHTML='fte:';
				}
			else if (mylbl=="FASE2" || mylbl=="M&C") {
					document.getElementById('divlbl').style.display='inline';
				         document.getElementById('lblriclbl').innerHTML='m.p.:';
				}
			else  {document.getElementById('divlbl').style.display='none';}
		};

	function metacalc() {
			var msez= document.getElementById('ricsez').value;
			var mylbl= document.getElementById('rictag2').value;
			if (mylbl=="META" || mylbl=="ESP" || mylbl=="FASE2" || mylbl=="M&C") {
			   myfte=document.getElementById('riclbl').value;
			   mycap=document.getElementById('riccapitolo').value;
			   if (mycap=="missioni") {
			           var mykeur= myfte*myrates[msez]+0.25;
		                   var a = parseInt(mykeur);
			           if ((mykeur-a)<0.5) mykeur=a;
				   else mykeur=a+0.5;
				   document.getElementById('keur').value=mykeur;
					   if (mylbl=="META" || mylbl=="ESP" ) {
							   document.getElementById('rich').value=myfte+"fte*1mp/fte*"+myrates[msez]+"KEuro/mp";}
				      else document.getElementById('rich').value=myfte+"mp/fte*"+myrates[msez]+"KEuro/mp";
		                }
				else {
				   var mykeur=myfte*1.5+0.25;
		                   var a = parseInt(mykeur);
			           if ((mykeur-a)<0.5) mykeur=a;
				   else mykeur=a+0.5;
				   document.getElementById('keur').value=mykeur;
			           document.getElementById('rich').value=myfte+"fte*"+"1.5KEuro/fte";
				}
		        }	
		};
</script>

</head>
<body>

<h2> Nuova Richiesta: </h2>

<!--
<form id="myentr"  method="post">
-->
<form id="myentr" method="post">
 <div class="w3-panel w3-border w3-theme-l5  w3-round-xlarge">
<select id="ricanno" name="anno" class="entrasel">>
  <option value="2010">Anno:</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
</select>

<select id="ricsez" name="sez" class="entrasel"> 
  <option value="">Sezione:</option>
  <option value="BA">BA</option>
  <option value="BO">BO</option>
  <option value="CT">CT</option>
  <option value="FI">FI</option>
  <option value="GE">GE</option>
  <option value="LNL">LNL</option>
  <option value="LNF">LNF</option>
  <option value="MIB">MIB</option>
  <option value="NA">NA</option>
  <option value="PD">PD</option>
  <option value="PG">PG</option>
  <option value="PI">PI</option>
  <option value="PV">PV</option>
  <option value="RM1">RM1</option>
  <option value="TO">TO</option>
  <option value="TS">TS</option>
</select>

<select id="ricsigla" name="sigla" class="entrasel">
  <option value="cms">Sigla:</option>
  <option value="cms">cms</option>
  <option value="fase2">fase2</option>
</select>

<select id="riccapitolo" name="capitolo" class="entrasel">
  <option value="0">Capitolo:</option>
  <option value="missioni">missioni</option>
  <option value="consumo">consumo</option>
  <option value="apparati">apparati</option>
  <option value="inventario">inventario</option>
  <option value="manutenzione">manutenzione</option>
  <option value="trasporti">trasporti</option>
  <option value="licenze-sw">licenze-sw</option>
  <option value="spservizi">spservizi</option>
</select>
<!--
<select id="rictag" name="tag" class="entrasel">
   <option value="0">TAG</option>
   <option value="DT_CORE">DT-CORE</option>
   <option value="ECAL-CORE">ECAL-CORE</option>
   <option value="GEM-CORE">GEM-CORE</option>
   <option value="L1TRIGGER-CORE">L1TRIGGER-CORE</option>
   <option value="ME0-CORE">ME0-CORE</option>
   <option value="MTD-CORE">MTD-CORE</option>
   <option value="RPC-CORE">RPC-CORE</option>
   <option value="TRACKER-CORE">TRACKER-CORE</option>
</select>
-->

<select id="rictag" name="tag1" class="entrasel">
   <option value="">TAG-PRJ</option>
   <option value="CMS">CMS</option>
   <option value="CALCOLO">CALCOLO</option>
   <option value="DT">DT</option>
   <option value="FISICA">FISICA</option>
   <option value="ECAL">ECAL</option>
   <option value="GEM">GEM</option>
   <option value="L1TRIGGER">L1TRIGGER</option>
   <option value="ME0">ME0</option>
   <option value="MTD">MTD</option>
   <option value="PPS">PPS</option>
   <option value="RPC">RPC</option>
   <option value="TETRABALL">TETRABALL</option>
   <option value="TRACKER">TRACKER</option>
</select>   
<select id="rictag2" name="tag2" class="entrasel" onchange="metalbl();">
   <option value="">TAG-CAT</option>
   <option value="CORE">CORE</option>
   <option value="PREPROTO">PREPROTO</option>
   <option value="INFRA">INFRA</option>
   <option value="MOF-A">MOF-A</option>
   <option value="MOF-B">MOF-B</option>
   <option value="META">META</option>
   <option value="RESP">RESP</option>
   <option value="ESP">ESP</option>
   <option value="FASE2">FASE2</option>
   <option value="M&C">M&C</option>
</select>   
<select id="rictag3" name="tag3" class="entrasel" onchange="respcalc();">
   <option value="">LVL</option>
   <option value="L0">L0</option>
   <option value="L1">L1</option>
   <option value="L2">L2</option>
   <option value="L3">L3</option>
   <option value="nc">nc</option>
   <option value="L1.5">L1.5</option>
</select>

<div id="divlbl" class="fte">
<label id="lblriclbl" for="riclbl">fte:</label>
<input type="text" id="riclbl" name="lbl"  onchange="metacalc();">
</div>

<label for="ricwbs">WBS:</label>
<input type="text" id="ricwbs" name="wbs" class="entrasel">

</div>
<div class="w3-panel w3-border w3-theme-l2  w3-round-xlarge">
  <label for="rich">Richiesta :</label>
  <input type="text" id="rich" name="rich" size="80" height="100"><br>
</div>
<div class="w3-panel w3-theme-l1 w3-round-xlarge">
  <label for="descrizione">Descrizione:</label>
  <textarea name="descrizione" form="myentr" rows="6" cols="80"> </textarea>
</div>

<div class="w3-panel w3-border w3-theme  w3-round-xlarge">
  <table class="w3-table w3-stripedi">
  <tr>

  <td>
   <label for="keur">kEur:</label><br>
   <input type="text" id="keur" name="keur" value="0.0"><br><br>
  </td>
  <td>
   <label for="keur">SJ:</label><br>
   <input type="text" id="sj" name="sj" value="0.0"><br><br>
  </td>
 </tr>
 <tr>
  <td>
  <label for="note">Note:</label><br>
  <!-- <input type="note" id="note" name="note"><br><br>
  -->
   <select id="note" name="note" class="entrasel" >
   <option value=""></option>
   <option value="CAT A+">Cat.A+</option>
   <option value="CAT A">Cat.A</option>
   <option value="CAT B">Cat.B</option>
   <option value="CAT C">Cat.C</option>
</select>

   </td>
  </tr>
  </table>
</div>

  <input type="checkbox" id="cernbox" name="folder" value="folder">
  <label for="checkbox"> Create docs folder</label><br>
  <input type="submit" id="msubmit" name="msubmit" value="Inserisci">

</div>

</form>
  <button onclick="document.getElementById('id04').style.display='none';">Cancel</button>

<!-- <p id="demo">Fetch output</p> -->


<script>
    console.log("you loaded the form");
    var theform=document.getElementById("myentr");
theform.action="entra.php";
   

theform.addEventListener("submit", function(event){
    event.preventDefault();
    fetch(theform.action, {
        method: "post",
        body: new URLSearchParams(new FormData(theform)) // for application/x-www-form-urlencoded
    })
    console.log("you submitted the form");
    document.getElementById('id04').style.display='none';
    document.getElementById('id01').style.display='block';
    showRichie(richie.value);
});

</script>
</body>
</html>

